{% extends "core/navigation.html" %}
{% load static %}

{% block css %}
    <link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.18.0/dist/bootstrap-table.min.css">
{% endblock %}

{% block content %}
    <p class="h5 text-break">{{ title }}</p>
    <p class="h5 text-break">{{ track_count }} tracks</p>
    {% if deleted_track_count %}
        <p class="h5 text-break text-danger">{{ deleted_track_count }} deleted tracks</p>
    {% endif %}
    <div id="tracks-table" class="table-borderless table-sm"></div>

{% endblock %}

{% block javascript %}

    <script src="https://unpkg.com/bootstrap-table@1.18.0/dist/bootstrap-table.min.js"></script>

    <script type="text/javascript">
        var tableData = {{ tracks_json | safe }};

        $('#tracks-table').bootstrapTable({
            sortReset: true,
            sortStable: true,
            search: true,
            searchHighlight: true,
            searchAlign: "left",
            rowStyle: "rowStyle",
            columns: [
                {title: "Thumbnail", field: "thumbnail", formatter: "imageFormatter", searchable: false},
                {title: "Title", field: "title", sortable: true, searchable: true},
                {title: "Artist", field: "artist", sortable: true, searchable: true},
                {title: "Duration", field: "duration", sortable: true, searchable: false},
                {title: "Added", field: "added", sortable: true, searchable: false},
            ],
            data: tableData
        })

        function imageFormatter(value, row) {
            return `<a href="${row.url}"><img src=${value} style="object-fit: cover; height: 45px; width: 80px"></a>`
        }

        function rowStyle(row, index) {
            if (row.deleted) {
                return {
                    css: {"color": "#e74c3c"}
                };
            }
            return {};
        }

        o

    </script>
{% endblock %}